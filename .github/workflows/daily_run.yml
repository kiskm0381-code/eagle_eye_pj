name: Daily Eagle Eye Scan

on:
  schedule:
    # æ¯æ—¥ æ—¥æœ¬æ™‚é–“ æœ4:00 (UTC 19:00) ã«å®Ÿè¡Œ
    - cron: '0 19 * * *'
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚‚ã¤ã‘ã‚‹

permissions:
  contents: write # ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹æ¨©é™ã‚’ä¸ãˆã‚‹

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4

      - name: Pythonã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: |
          pip install google-generativeai

      - name: Eagle Eye (Python) ã‚’å®Ÿè¡Œ
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: |
          python main.py

      - name: çµæœã‚’ä¿å­˜ (Git Commit & Push)
        run: |
          git config --global user.name "EagleEye-Bot"
          git config --global user.email "bot@example.com"
          git add eagle_eye_data.json
          # å¤‰æ›´ãŒã‚ã‚‹å ´åˆã®ã¿ã‚³ãƒŸãƒƒãƒˆ
          git diff --quiet && git diff --staged --quiet || (git commit -m "ğŸ¤– Update Forecast Data" && git push)
